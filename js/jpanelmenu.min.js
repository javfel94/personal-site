!function(a){a.jPanelMenu=function(n){void 0!==n&&null!=n||(n={});var r={options:a.extend({menu:"#menu",panel:"body",trigger:".menu-trigger",excludedPanelContent:"style, script",clone:!0,keepEventHandlers:!1,direction:"left",openPosition:"250px",animated:!0,closeOnContentClick:!0,keyboardShortcuts:[{code:27,open:!1,close:!0},{code:37,open:!1,close:!0},{code:39,open:!0,close:!0},{code:77,open:!0,close:!0}],duration:150,openDuration:n.duration||150,closeDuration:n.duration||150,easing:"ease-in-out",openEasing:n.easing||"ease-in-out",closeEasing:n.easing||"ease-in-out",before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},n),settings:{transitionsSupported:"WebkitTransition"in document.body.style||"MozTransition"in document.body.style||"msTransition"in document.body.style||"OTransition"in document.body.style||"Transition"in document.body.style,transformsSupported:"WebkitTransform"in document.body.style||"MozTransform"in document.body.style||"msTransform"in document.body.style||"OTransform"in document.body.style||"Transform"in document.body.style,cssPrefix:"",panelPosition:"static",positionUnits:"px"},menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",timeouts:{},clearTimeouts:function(){clearTimeout(r.timeouts.open),clearTimeout(r.timeouts.afterOpen),clearTimeout(r.timeouts.afterClose)},setPositionUnits:function(){for(var n=!1,e=["%","px","em"],t=0;t<e.length;t++){var o=e[t];r.options.openPosition.toString().substr(-o.length)==o&&(n=!0,r.settings.positionUnits=o)}n||(r.options.openPosition=parseInt(r.options.openPosition)+r.settings.positionUnits)},computePositionStyle:function(n,e){var t=n?r.options.openPosition:"0"+r.settings.positionUnits,o={};if(r.settings.transformsSupported){var i="translate3d("+(n&&"right"==r.options.direction?"-":"")+t+",0,0)",s="transform";e?((o="")!=r.settings.cssPrefix&&(o=r.settings.cssPrefix+s+":"+i+";"),o+=s+":"+i+";"):(""!=r.settings.cssPrefix&&(o[r.settings.cssPrefix+s]=i),o[s]=i)}else e?(o="",o=r.options.direction+": "+t+";"):o[r.options.direction]=t;return o},setCSSPrefix:function(){r.settings.cssPrefix=r.getCSSPrefix()},setjPanelMenuStyles:function(){var n="background:#fff",e=a("html").css("background-color"),t=a("body").css("background-color"),o=function(t){var o=[];return a.each(["background-color","background-image","background-position","background-repeat","background-attachment","background-size","background-clip"],function(n,e){""!==t.css(e)&&o.push(e+":"+t.css(e))}),o.join(";")};"transparent"!==t&&"rgba(0, 0, 0, 0)"!==t?n=o(a("body")):"transparent"!==e&&"rgba(0, 0, 0, 0)"!==e&&(n=o(a("html"))),0==a("#jPanelMenu-style-master").length&&a("body").append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+r.options.direction+":0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;"+r.options.direction+":0;top:0;z-index:2;width:100%;min-height:100%;"+n+";}</style>")},setMenuState:function(n){var e=n?"open":"closed";a(r.options.panel).attr("data-menu-position",e)},getMenuState:function(){return a(r.options.panel).attr("data-menu-position")},menuIsOpen:function(){return"open"==r.getMenuState()},setMenuStyle:function(n){a(r.menu).css(n)},setPanelStyle:function(n){a(r.panel).css(n)},showMenu:function(){r.setMenuStyle({display:"block"}),r.setMenuStyle({"z-index":"1"})},hideMenu:function(){r.setMenuStyle({"z-index":"-1"}),r.setMenuStyle({display:"none"})},enableTransitions:function(n,e){var t=n/1e3,o=r.getCSSEasingFunction(e);r.disableTransitions(),a("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{'+r.settings.cssPrefix+"transition: all "+t+"s "+o+"; transition: all "+t+"s "+o+";}</style>")},disableTransitions:function(){a("#jPanelMenu-style-transitions").remove()},getCSSEasingFunction:function(n){switch(n){case"linear":case"ease":case"ease-in":case"ease-out":case"ease-in-out":return n;default:return"ease-in-out"}},getJSEasingFunction:function(n){switch(n){case"linear":return n;default:return"swing"}},getVendorPrefix:function(){if("result"in arguments.callee)return arguments.callee.result;var n=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,e=document.getElementsByTagName("script")[0];for(var t in e.style)if(n.test(t))return arguments.callee.result=t.match(n)[0];return"WebkitOpacity"in e.style?arguments.callee.result="Webkit":"KhtmlOpacity"in e.style?arguments.callee.result="Khtml":arguments.callee.result=""},getCSSPrefix:function(){var n=r.getVendorPrefix();return""!=n?"-"+n.toLowerCase()+"-":""},openMenu:function(n){void 0!==n&&null!=n||(n=r.options.animated),r.clearTimeouts(),r.options.before(),r.options.beforeOpen(),r.setMenuState(!0),r.showMenu();var e=!n,t=!(!n||!r.settings.transitionsSupported);if(t||e){e&&r.disableTransitions(),t&&r.enableTransitions(r.options.openDuration,r.options.openEasing);var o=r.computePositionStyle(!0);r.setPanelStyle(o),r.timeouts.afterOpen=setTimeout(function(){r.options.after(),r.options.afterOpen(),r.initiateContentClickListeners()},r.options.openDuration)}else{var i=r.getJSEasingFunction(r.options.openEasing),s={};s[r.options.direction]=r.options.openPosition,a(r.panel).stop().animate(s,r.options.openDuration,i,function(){r.options.after(),r.options.afterOpen(),r.initiateContentClickListeners()})}},closeMenu:function(n){void 0!==n&&null!=n||(n=r.options.animated),r.clearTimeouts(),r.options.before(),r.options.beforeClose(),r.setMenuState(!1);var e=!n,t=!(!n||!r.settings.transitionsSupported);if(t||e){e&&r.disableTransitions(),t&&r.enableTransitions(r.options.closeDuration,r.options.closeEasing);var o=r.computePositionStyle();r.setPanelStyle(o),r.timeouts.afterClose=setTimeout(function(){r.disableTransitions(),r.hideMenu(),r.options.after(),r.options.afterClose(),r.destroyContentClickListeners()},r.options.closeDuration)}else{var i=r.getJSEasingFunction(r.options.closeEasing),s={};s[r.options.direction]=0+r.settings.positionUnits,a(r.panel).stop().animate(s,r.options.closeDuration,i,function(){r.hideMenu(),r.options.after(),r.options.afterClose(),r.destroyContentClickListeners()})}},triggerMenu:function(n){r.menuIsOpen()?r.closeMenu(n):r.openMenu(n)},initiateClickListeners:function(){a(document).on("click touchend",r.options.trigger,function(n){r.triggerMenu(r.options.animated),n.preventDefault()})},destroyClickListeners:function(){a(document).off("click touchend",r.options.trigger,null)},initiateContentClickListeners:function(){if(!r.options.closeOnContentClick)return!1;a(document).on("click touchend",r.panel,function(n){r.menuIsOpen()&&r.closeMenu(r.options.animated),n.preventDefault()})},destroyContentClickListeners:function(){if(!r.options.closeOnContentClick)return!1;a(document).off("click touchend",r.panel,null)},initiateKeyboardListeners:function(){var i=["input","textarea","select"];a(document).on("keydown",function(n){var e=a(n.target),t=!1;if(a.each(i,function(){e.is(this.toString())&&(t=!0)}),t)return!0;for(mapping in r.options.keyboardShortcuts)if(n.which==r.options.keyboardShortcuts[mapping].code){var o=r.options.keyboardShortcuts[mapping];o.open&&o.close?r.triggerMenu(r.options.animated):!o.open||o.close||r.menuIsOpen()?!o.open&&o.close&&r.menuIsOpen()&&r.closeMenu(r.options.animated):r.openMenu(r.options.animated),n.preventDefault()}})},destroyKeyboardListeners:function(){a(document).off("keydown",null)},setupMarkup:function(){a("html").addClass("jPanelMenu"),a(r.options.panel+" > *").not(r.menu+", "+r.options.excludedPanelContent).wrapAll('<div class="'+r.panel.replace(".","")+'"/>'),(r.options.clone?a(r.options.menu).clone(r.options.keepEventHandlers):a(r.options.menu)).attr("id",r.menu.replace("#","")).insertAfter(r.options.panel+" > "+r.panel)},resetMarkup:function(){a("html").removeClass("jPanelMenu"),a(r.options.panel+" > "+r.panel+" > *").unwrap(),a(r.menu).remove()},init:function(){r.options.beforeOn(),r.setPositionUnits(),r.setCSSPrefix(),r.initiateClickListeners(),"[object Array]"===Object.prototype.toString.call(r.options.keyboardShortcuts)&&r.initiateKeyboardListeners(),r.setjPanelMenuStyles(),r.setMenuState(!1),r.setupMarkup(),r.setPanelStyle({position:r.options.animated&&"static"===r.settings.panelPosition?"relative":r.settings.panelPosition}),r.setMenuStyle({width:r.options.openPosition}),r.closeMenu(!1),r.options.afterOn()},destroy:function(){r.options.beforeOff(),r.closeMenu(),r.destroyClickListeners(),"[object Array]"===Object.prototype.toString.call(r.options.keyboardShortcuts)&&r.destroyKeyboardListeners(),r.resetMarkup();({})[r.options.direction]="auto",r.options.afterOff()}};return{on:r.init,off:r.destroy,trigger:r.triggerMenu,open:r.openMenu,close:r.closeMenu,isOpen:r.menuIsOpen,menu:r.menu,getMenu:function(){return a(r.menu)},panel:r.panel,getPanel:function(){return a(r.panel)},setPosition:function(n){void 0!==n&&null!=n||(n=r.options.openPosition),r.options.openPosition=n,r.setMenuStyle({width:r.options.openPosition})}}}}(jQuery);